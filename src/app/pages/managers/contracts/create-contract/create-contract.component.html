<div class="p-6 bg-gray-100 ">
  <div class=" bg-white rounded-xl shadow-lg p-8">
    <h2 class="text-3xl font-bold text-gray-800 mb-6 text-center">
      Gestão de Clientes e Contratos
    </h2>
    <div class="flex border-b border-gray-200 mb-6">
      <!-- Botão para a Aba de Cliente -->
      <button
        class="py-3 px-6 text-lg font-medium transition-colors duration-200 ease-in-out"
        [ngClass]="{
          'text-indigo-600 border-b-2 border-indigo-600': activeTab === 'client',
          'text-gray-500 hover:text-gray-700': activeTab !== 'client'
        }"
        (click)="selectTab('client')"
      >
        Dados do Cliente
      </button>

      <!-- Botão para a Aba de Contrato -->
      <button
        class="py-3 px-6 text-lg font-medium transition-colors duration-200 ease-in-out"
        [ngClass]="{
          'text-indigo-600 border-b-2 border-indigo-600': activeTab === 'contract',
          'text-gray-500 hover:text-gray-700': activeTab !== 'contract'
        }"
        (click)="selectTab('contract')"
      >
        Dados do Contrato
      </button>
    </div>

    <!-- Conteúdo da Aba de Cliente -->
    <div *ngIf="activeTab === 'client'">
      <form [formGroup]="clientForm" (ngSubmit)="saveClient()">
        <h3 class="text-2xl font-semibold text-gray-700 mb-4">
          Preencha os dados do novo cliente
        </h3>
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Nome</label>
            <input type="text" formControlName="name" placeholder="Nome Completo"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <div *ngIf="clientForm.get('name')?.invalid && clientForm.get('name')?.touched" class="text-red-500 text-xs mt-1">
              Nome é obrigatório.
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
            <input type="text" formControlName="phoneNumber" #phoneNumber placeholder="00-000-0000"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
              (input)="onNumberInputChange(phoneNumber)" />
            <div *ngIf="clientForm.get('phoneNumber')?.invalid && clientForm.get('phoneNumber')?.touched" class="text-red-500 text-xs mt-1">
              Telefone é obrigatório.
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Morada</label>
            <input type="text" formControlName="address" placeholder="Endereço do Cliente"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <div *ngIf="clientForm.get('address')?.invalid && clientForm.get('address')?.touched" class="text-red-500 text-xs mt-1">
              Morada é obrigatória.
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">NUIT</label>
            <input type="text" formControlName="nuit" #nuit placeholder="NUIT do Cliente (Opcional)"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
              (input)="onNumberInputChange(nuit)" />
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Zona</label>
            <select formControlName="zoneId"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
              <option *ngFor="let zone of zoneData" [value]="zone.value">{{ zone.label }}</option>
            </select>
            <div *ngIf="clientForm.get('zoneId')?.invalid && clientForm.get('zoneId')?.touched" class="text-red-500 text-xs mt-1">
              Zona é obrigatória.
            </div>
          </div>
           
        </div>
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
          <textarea formControlName="observation" rows="3" placeholder="Observações (Opcional)"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
        </div>
        <div class="flex items-center space-x-6 mb-6">
          <div class="flex items-center">
            <input type="checkbox" formControlName="exemptFromFines"
              class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
            <label class="ml-2 block text-sm text-gray-900">Isento de Multas</label>
          </div>
          <div class="flex items-center">
            <input type="checkbox" formControlName="wantsReceiptSMS"
              class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
            <label class="ml-2 block text-sm text-gray-900">Receber SMS de Recibos</label>
          </div>
          <div class="flex items-center">
            <input type="checkbox" formControlName="wantsInvoiceSMS"
              class="h-4 w-4 text-indigo-600 border-gray-300 rounded focus:ring-indigo-500">
            <label class="ml-2 block text-sm text-gray-900">Receber SMS de Faturas</label>
          </div>
        </div>
        <div class="flex justify-end">
          <button type="submit" [disabled]="clientForm.invalid || (isClientSaving$ | async)"
            class="px-6 py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700 transition-colors duration-200 ease-in-out disabled:opacity-50">
            <span *ngIf="!(isClientSaving$ | async)">Criar Cliente</span>
            <span *ngIf="isClientSaving$ | async">Salvando...</span>
          </button>
        </div>
      </form>
    </div>

    <!-- Conteúdo da Aba de Contrato -->
    <div *ngIf="activeTab === 'contract'">
      <form [formGroup]="contractForm" (ngSubmit)="saveContract()">
        <h3 class="text-2xl font-semibold text-gray-700 mb-4">
          Preencha os dados do novo contrato
        </h3>
        <div class="grid md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Cliente</label>
            <select formControlName="clientId"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
              <option *ngFor="let client of clientData" [value]="client.value">{{ client.label }}</option>
            </select>
            <div *ngIf="contractForm.get('clientId')?.invalid && contractForm.get('clientId')?.touched" class="text-red-500 text-xs mt-1">
              Cliente é obrigatório.
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Medidor</label>
            <select formControlName="meterId"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
              <option *ngFor="let meter of meterData" [value]="meter.value">{{ meter.label }}</option>
            </select>
            <div *ngIf="contractForm.get('meterId')?.invalid && contractForm.get('meterId')?.touched" class="text-red-500 text-xs mt-1">
              Medidor é obrigatório.
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Tipo de Contrato</label>
            <select formControlName="contractTypeId"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500">
              <option *ngFor="let type of contractTypeData" [value]="type.value">{{ type.label }}</option>
            </select>
            <div *ngIf="contractForm.get('contractTypeId')?.invalid && contractForm.get('contractTypeId')?.touched" class="text-red-500 text-xs mt-1">
              Tipo de Contrato é obrigatório.
            </div>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Data de Início</label>
            <input type="date" formControlName="startDate"
              class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500" />
            <div *ngIf="contractForm.get('startDate')?.invalid && contractForm.get('startDate')?.touched" class="text-red-500 text-xs mt-1">
              Data de Início é obrigatória.
            </div>
          </div>
        </div>
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
          <textarea formControlName="description" rows="3" placeholder="Descrição do contrato (Opcional)"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"></textarea>
        </div>
        <div class="flex justify-end">
          <button type="submit" [disabled]="contractForm.invalid || (isContractSaving$ | async)"
            class="px-6 py-3 bg-indigo-600 text-white font-bold rounded-lg shadow-md hover:bg-indigo-700 transition-colors duration-200 ease-in-out disabled:opacity-50">
            <span *ngIf="!(isContractSaving$ | async)">Criar Contrato</span>
            <span *ngIf="isContractSaving$ | async">Salvando...</span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
